# çµ¦æ²¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

## ğŸ”¥ ã‚¨ãƒãƒ•ãƒ¬ï¼ˆEnefleï¼‰é–¢é€£API

### CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- `POST /api/fuel/enefle/upload`
  - ã‚¨ãƒãƒ•ãƒ¬CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  - ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: multipart/form-data (file)
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ã‚¤ãƒ³ãƒãƒ¼ãƒˆçµæœçµ±è¨ˆ

### ãƒ‡ãƒ¼ã‚¿å–å¾—
- `GET /api/fuel/enefle/`
  - ã‚¨ãƒãƒ•ãƒ¬çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ä¸€è¦§å–å¾—ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:
    - `page`: ãƒšãƒ¼ã‚¸ç•ªå· (default: 1)
    - `per_page`: 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•° (max: 100, default: 50)
    - `vehicle_number`: è»Šä¸¡ç•ªå·ãƒ•ã‚£ãƒ«ã‚¿
    - `start_date`: é–‹å§‹æ—¥ (YYYY-MM-DD)
    - `end_date`: çµ‚äº†æ—¥ (YYYY-MM-DD)
    - `fuel_only`: çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ã®ã¿ (default: true)

- `GET /api/fuel/enefle/{record_id}`
  - ç‰¹å®šã®ã‚¨ãƒãƒ•ãƒ¬çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿å–å¾—

- `GET /api/fuel/enefle/summary`
  - ã‚¨ãƒãƒ•ãƒ¬çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆæƒ…å ±
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: `start_date`, `end_date`

### ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
- `DELETE /api/fuel/enefle/{record_id}`
  - ã‚¨ãƒãƒ•ãƒ¬çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤

## ğŸ”¥ ã‚¨ãƒã‚ªã‚¹ã‚¦ã‚£ãƒ³ã‚°ï¼ˆENEOS Wingï¼‰é–¢é€£API

### CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- `POST /api/fuel/eneos-wing/upload`
  - ã‚¨ãƒã‚ªã‚¹ã‚¦ã‚£ãƒ³ã‚°CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### ãƒ‡ãƒ¼ã‚¿å–å¾—
- `GET /api/fuel/eneos-wing/`
  - ã‚¨ãƒã‚ªã‚¹ã‚¦ã‚£ãƒ³ã‚°çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ä¸€è¦§å–å¾—
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ã‚¨ãƒãƒ•ãƒ¬ã¨åŒæ§˜

- `GET /api/fuel/eneos-wing/summary`
  - ã‚¨ãƒã‚ªã‚¹ã‚¦ã‚£ãƒ³ã‚°çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆæƒ…å ±

## ğŸ”¥ ã‚­ã‚¿ã‚»ã‚­ç¤¾é–¢é€£API

### CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- `POST /api/fuel/kitaseki/upload`
  - ã‚­ã‚¿ã‚»ã‚­ç¤¾CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### ãƒ‡ãƒ¼ã‚¿å–å¾—
- `GET /api/fuel/kitaseki/`
  - ã‚­ã‚¿ã‚»ã‚­ç¤¾çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ä¸€è¦§å–å¾—
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ä»–ã¨åŒæ§˜

- `GET /api/fuel/kitaseki/{record_id}`
  - ç‰¹å®šã®ã‚­ã‚¿ã‚»ã‚­ç¤¾çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿å–å¾—

- `GET /api/fuel/kitaseki/summary`
  - ã‚­ã‚¿ã‚»ã‚­ç¤¾çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆæƒ…å ±

- `GET /api/fuel/kitaseki/vehicles`
  - ã‚­ã‚¿ã‚»ã‚­ç¤¾ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹è»Šä¸¡ä¸€è¦§

### ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
- `DELETE /api/fuel/kitaseki/{record_id}`
  - ã‚­ã‚¿ã‚»ã‚­ç¤¾çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤

## ğŸ”¥ çµ±åˆãƒ»æ¨ªæ–­åˆ†æAPI

### å…¨ç¤¾çµ±åˆçµ±è¨ˆ
- `GET /api/fuel/summary`
  - å…¨ç¤¾åˆè¨ˆã®çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆï¼ˆã‚¨ãƒãƒ•ãƒ¬ + ã‚¨ãƒã‚ªã‚¹ã‚¦ã‚£ãƒ³ã‚° + ã‚­ã‚¿ã‚»ã‚­ï¼‰
  - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: `start_date`, `end_date`
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹:
    ```json
    {
      "combined_summary": {
        "total_transactions": 1500,
        "total_liters": 45000.5,
        "total_amount": 6750000
      },
      "by_company": {
        "enefle": { "transactions": 800, "liters": 24000, "amount": 3600000 },
        "eneos_wing": { "transactions": 500, "liters": 15000, "amount": 2250000 },
        "kitaseki": { "transactions": 200, "liters": 6000.5, "amount": 900000 }
      },
      "top_vehicles": [...]
    }
    ```

## ğŸ“Š ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹

### çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "records": [
    {
      "id": 1,
      "transaction_date": "2025-06-01",
      "vehicle_number": "ç¾¤é¦¬100ã‚1234",
      "station_name": "â—‹â—‹SS",
      "product_name": "è»½æ²¹",
      "quantity": 45.5,
      "unit_price": 150.0,
      "total_amount": 6825
    }
  ],
  "pagination": {
    "page": 1,
    "per_page": 50,
    "total": 150,
    "pages": 3,
    "has_prev": false,
    "has_next": true
  }
}
```

### çµ±è¨ˆæƒ…å ±ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "summary": {
    "total_transactions": 150,
    "total_liters": 4500.5,
    "total_amount": 675000,
    "avg_unit_price": 150.0,
    "unique_vehicles": 25
  },
  "top_vehicles": [
    {
      "vehicle_number": "ç¾¤é¦¬100ã‚1234",
      "transaction_count": 15,
      "total_liters": 675.5,
      "total_amount": 101325
    }
  ]
}
```

## ğŸ”§ CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "message": "CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ",
  "total_rows": 1000,
  "imported_count": 950,
  "skipped_count": 30,
  "error_count": 20,
  "errors": [
    "è¡Œ 15: æ—¥ä»˜å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“",
    "è¡Œ 23: è»Šç•ªãŒç©ºã§ã™"
  ]
}
```

## ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "error": "ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"
}
```

## ğŸ“ æ³¨æ„äº‹é …
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã¯`multipart/form-data`å½¢å¼ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- æ—¥ä»˜ãƒ•ã‚£ãƒ«ã‚¿ã¯`YYYY-MM-DD`å½¢å¼
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã¯æœ€å¤§100ä»¶/ãƒšãƒ¼ã‚¸
- çµ¦æ²¹ãƒ‡ãƒ¼ã‚¿ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿ã¯æ¶ˆè²»ç¨èª¿æ•´ãƒ‡ãƒ¼ã‚¿ã‚’é™¤å¤–
- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹